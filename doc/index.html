
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Modern PHP Mocking Framwork for PHP7 and PHP8.
">
      
      
      
        <link rel="canonical" href="https://phake.github.io/doc/">
      
      
        <link rel="prev" href="../getting-started/">
      
      
        <link rel="next" href="mocks/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.3">
    
    
      
        <title>Introduction - Phake - PHP Mocking Framework</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.d7758b05.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-ZH298BGVL6"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-ZH298BGVL6",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-ZH298BGVL6",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#introduction-to-phake" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Phake - PHP Mocking Framework" class="md-header__button md-logo" aria-label="Phake - PHP Mocking Framework" data-md-component="logo">
      
  <img src="../assets/images/phake-white.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Phake - PHP Mocking Framework
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Introduction
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/phake/phake" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    phake/phake
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../getting-started/" class="md-tabs__link">
        
  
    
  
  Getting started

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
  Documentation

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../cheat-sheet/" class="md-tabs__link">
        
  
    
  
  Cheat sheet

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Phake - PHP Mocking Framework" class="md-nav__button md-logo" aria-label="Phake - PHP Mocking Framework" data-md-component="logo">
      
  <img src="../assets/images/phake-white.svg" alt="logo">

    </a>
    Phake - PHP Mocking Framework
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/phake/phake" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    phake/phake
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting started
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Documentation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="mocks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Creating Mocks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="stubbing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Method Stubbing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="method-verification/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Method Verification
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="mocking-statics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mocking Static Methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="answers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Answers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="method-parameter-matchers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Method Parameter Matchers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_9" >
        
          
          <label class="md-nav__link" for="__nav_3_9" id="__nav_3_9_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Cookbooks
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_9">
            <span class="md-nav__icon md-icon"></span>
            Cookbooks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="cookbooks/annotations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using Annotations
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../cheat-sheet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cheat sheet
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="introduction-to-phake">Introduction to Phake<a class="headerlink" href="#introduction-to-phake" title="Permanent link"> ¶</a></h1>
<p><strong>Phake</strong> is a mocking framework for PHP. It allows for the creation of objects that mimic a real
object in a predictable and controlled manner. This allows you to treat external method calls
made by your system under test (SUT) as just another form of input to your SUT and output from
your SUT. This is done by stubbing methods that supply indirect input into your test and by
verifying parameters to methods that receive indirect output from your test.</p>
<p>In true Las Vegas spirit I am implementing a new framework that allows you to easily create
new card games. Most every card game at one point or another needs a dealer. In the example below
I have created a new class called <code>CardGame</code> that implements the basic functionality for a card game:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">CardGame</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="nx">DealerStrategy</span>   <span class="nv">$dealerStrategy</span><span class="p">;</span>
    <span class="k">private</span> <span class="nx">CardCollection</span>   <span class="nv">$deck</span><span class="p">;</span>
    <span class="k">private</span> <span class="nx">PlayerCollection</span> <span class="nv">$players</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">CardGame</span><span class="p">(</span><span class="nx">DealerStrategy</span> <span class="nv">$dealerStrategy</span><span class="p">,</span> <span class="nx">CardCollection</span> <span class="nv">$deck</span><span class="p">,</span> <span class="nx">PlayerCollection</span> <span class="nv">$players</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">dealerStrategy</span> <span class="o">=</span> <span class="nv">$dealerStrategy</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">deck</span> <span class="o">=</span> <span class="nv">$deck</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">players</span> <span class="o">=</span> <span class="nv">$players</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">dealCards</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">deck</span><span class="o">-&gt;</span><span class="na">shuffle</span><span class="p">();</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">dealerStrategy</span><span class="o">-&gt;</span><span class="na">deal</span><span class="p">(</span><span class="nv">$deck</span><span class="p">,</span> <span class="nv">$players</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>If I want to create a new test to ensure that <code>dealCards()</code> works properly, what do I need to test?
Everything I read about testing says that I need to establish known input for my test, and then
test its output. However, in this case, I don’t have any parameters that are passed into <code>dealCards()</code>
nor do I have any return values I can check. I could just run the <code>dealCards()</code> method and make sure
I don’t get any errors or exceptions, but that proves little more than my method isn’t blowing up
spectacularly. It is apparent that I need to ensure that what I actually assert is that
the <code>shuffle()</code> and <code>deal()</code> methods are being called. If
I want to continue testing this using concrete
classes that already exist in my system, I could conjure up one of my implementations of <code>DealerStrategy</code>,
<code>CardCollection</code> and <code>PlayerCollection</code>. All of those
objects are closer to being true value objects
with a testable state. I could feasibly construct instances of those objects, pass them into an
instance of <code>CardGame</code>, call <code>dealCards()</code> and then assert
the state of those same objects. A test doing
this might look something like:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">CardGameTest1</span> <span class="k">extends</span> <span class="nx">PHPUnit\Framework\TestCase</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">testDealCards</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nv">$dealer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">FiveCardPokerDealer</span><span class="p">();</span>
        <span class="nv">$deck</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">StandardDeck</span><span class="p">();</span>
        <span class="nv">$player1</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Player</span><span class="p">();</span>
        <span class="nv">$player2</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Player</span><span class="p">();</span>
        <span class="nv">$player3</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Player</span><span class="p">();</span>
        <span class="nv">$player4</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Player</span><span class="p">();</span>
        <span class="nv">$players</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PlayerCollection</span><span class="p">([</span><span class="nv">$player1</span><span class="p">,</span> <span class="nv">$player2</span><span class="p">,</span> <span class="nv">$player3</span><span class="p">,</span> <span class="nv">$player4</span><span class="p">]);</span>

        <span class="nv">$cardGame</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CardGame</span><span class="p">(</span><span class="nv">$dealer</span><span class="p">,</span> <span class="nv">$deck</span><span class="p">,</span> <span class="nv">$players</span><span class="p">);</span>
        <span class="nv">$cardGame</span><span class="o">-&gt;</span><span class="na">dealCards</span><span class="p">();</span>

        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertEquals</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$player1</span><span class="o">-&gt;</span><span class="na">getCards</span><span class="p">()));</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertEquals</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$player2</span><span class="o">-&gt;</span><span class="na">getCards</span><span class="p">()));</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertEquals</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$player3</span><span class="o">-&gt;</span><span class="na">getCards</span><span class="p">()));</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertEquals</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="nb">count</span><span class="p">(</span><span class="nv">$player4</span><span class="o">-&gt;</span><span class="na">getCards</span><span class="p">()));</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>This test isn’t all that bad, it’s not difficult to understand and it does make sure that cards
are dealt through making sure that each player has 5 cards. There are at least two significant problems
with this test however. The first problem is that there is not any isolation of the SUT which in
this case is <code>dealCards()</code>. If something is broken in the <code>FiveCardPokerDealer</code>
class, the <code>Player</code> class,
or the <code>PlayerCollection</code> class, it will manifest itself here as a broken <code>CardGame</code>
class. Thinking
about how each of these classes might be implemented, one could easily make the argument that this
really tests the <code>FiveCardPokerDealer</code> class much more than the <code>dealCards()</code> method.
The second problem
is significantly more problematic. It is perfectly feasible that I could remove the call to <code>$this-&gt;deck-&gt;shuffle()</code>
in my SUT and the test I have created will still test just fine. In order to solidify my test I
need to introduce logic to ensure that the deck has been shuffled. With the current mindset of using
real objects in my tests I could wind up with incredibly complicated logic. I could feasibly add
an identifier of some sort to <code>DealerStrategy::shuffle()</code> to mark the deck as shuffled thereby making
it checkable state, however that makes my design more fragile as I would have to ensure that identifier
was set probably on every implementation of <code>DealerStrategy::shuffle()</code>.</p>
<p>This is the type of problem that mock frameworks solve. A mock framework such as Phake can
be used to create implementations of my <code>DealerStrategy</code>, <code>CardCollection</code>, and <code>PlayerCollection</code> classes.
I can then exercise my SUT. Finally, I can verify that the methods that should be called on these
objects were called correctly. If this test were
re-written to use Phake, it would become:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">CardGameTest2</span> <span class="k">extends</span> <span class="nx">PHPUnit\Framework\TestCase</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">testDealCards</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nv">$dealer</span>  <span class="o">=</span> <span class="nx">Phake</span><span class="o">::</span><span class="na">mock</span><span class="p">(</span><span class="nx">DealerStrategy</span><span class="o">::</span><span class="na">class</span><span class="p">);</span>
        <span class="nv">$deck</span>    <span class="o">=</span> <span class="nx">Phake</span><span class="o">::</span><span class="na">mock</span><span class="p">(</span><span class="nx">CardCollection</span><span class="o">::</span><span class="na">class</span><span class="p">);</span>
        <span class="nv">$players</span> <span class="o">=</span> <span class="nx">Phake</span><span class="o">::</span><span class="na">mock</span><span class="p">(</span><span class="nx">PlayerCollection</span><span class="o">::</span><span class="na">class</span><span class="p">);</span>

        <span class="nv">$cardGame</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CardGame</span><span class="p">(</span><span class="nv">$dealer</span><span class="p">,</span> <span class="nv">$deck</span><span class="p">,</span> <span class="nv">$players</span><span class="p">);</span>
        <span class="nv">$cardGame</span><span class="o">-&gt;</span><span class="na">dealCards</span><span class="p">();</span>

        <span class="nx">Phake</span><span class="o">::</span><span class="na">verify</span><span class="p">(</span><span class="nv">$deck</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">shuffle</span><span class="p">();</span>
        <span class="nx">Phake</span><span class="o">::</span><span class="na">verify</span><span class="p">(</span><span class="nv">$dealer</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">deal</span><span class="p">(</span><span class="nv">$deck</span><span class="p">,</span> <span class="nv">$players</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>There are three benefits of using mock objects that can be seen through this example. The first benefit
is that the brittleness of the fixture is reduced. In our previous example you see that I have to construct
a full object graph based on the dependencies of all of the classes involved. I am fortunate in
the first example that there are only 4 classes involved. In real world problems and especially
long lived, legacy code the object graphs can be much, much larger. When using mock objects you
typically only have to worry about the direct dependencies of your SUT. Specifically, direct dependencies
required to instantiate the dependencies of the class under test, the parameters passed to the method
under test (direct dependencies,) and the values returned by additional method calls within the
method under test (indirect dependencies.)</p>
<p>The second benefit is the test is only testing the SUT. If this test fails due to a change in anything
but the interfaces of the classes involved, the change would have had to been made in either the
constructor of <code>CardGame</code>, or the <code>dealCards()</code> method itself.
Obviously, if an interface change is
made (such as removing the <code>shuffle()</code>) method, then I would have a scenario
where the changed code is outside of this class. However, provided the removal of that method was
intentional, I will know that this code needs to be addressed as it is depending on a method that no longer exists.</p>
<p>The third benefit is that I have truer verification and assertions of the outcome of exercising
my SUT. In this case for instance, I can be sure that if the call to <code>shuffle()</code> is removed, this
test will fail. It also does it in a way that keeps the code necessary to assert your final state
simple and concise. This makes my test overall much easier to understand and maintain. There is
still one flaw with this example however. There is nothing here to ensure that <code>shuffle()</code> is called
before <code>deal()</code> it is quite possible for someone to mistakenly reverse the order of these two calls.
The Phake framework does have the ability to track call order to make this test even more bullet
proof via the <code>Phake::inOrder()</code> method. I will go over this in more detail later.</p>









  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; 2023 Created and maintained by <a href="https://github.com/mlively">Mike Lively</a>, <a href="https://github.com/bfeaver">Brian Feaver</a> and <a href="https://github.com/adoy">Pierrick Charron</a>.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["search.suggest", "search.highlight", "navigation.tracking", "navigation.tabs", "navigation.sections", "toc.integrate"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.f1b6f286.min.js"></script>
      
    
  </body>
</html>